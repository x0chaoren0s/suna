---
terminal: xiaohei_local
harvest_time: 2025-11-17T14:15:20Z
git_commits: 1
tasks_completed: 1
tasks_in_progress: 0
---

# 收获记忆 - 2025-11-17 Session 001

## 上下文
- Git提交：1个（修复乱码提交）
- 主要工作：解决 Windows Git 中文乱码问题
- 环境：Windows 10 本地开发环境

## 中期记忆

### Windows Git 中文乱码问题解决
**ID**: mem_20251117_003
**分类**: environment
**标签**: git, windows, encoding, utf-8, troubleshooting

**问题描述**：
在 Windows 环境下，Git 提交消息中的中文出现乱码，显示为类似 `銆愬皬榛戯細鏈湴銆戝涔犱簡2鏉℃柊璁板繂` 的乱码字符。

**问题原因**：
1. Windows 终端默认代码页为 GBK（936），而 Git 提交消息使用 UTF-8 编码
2. Git 未配置正确的编码设置（`i18n.commitencoding` 和 `i18n.logoutputencoding`）
3. PowerShell 和 CMD 未设置为 UTF-8 编码
4. 提交消息在编码转换过程中被错误解释和存储

**解决方案**：
1. **Git 配置 UTF-8 编码**：
   ```bash
   git config --global i18n.commitencoding utf-8
   git config --global i18n.logoutputencoding utf-8
   git config --global core.quotepath false
   ```

2. **PowerShell 设置 UTF-8**：
   - 创建配置文件：`Microsoft.PowerShell_profile.ps1`
   - 添加内容：
   ```powershell
   [Console]::OutputEncoding = [System.Text.Encoding]::UTF8
   [Console]::InputEncoding = [System.Text.Encoding]::UTF8
   $OutputEncoding = [System.Text.Encoding]::UTF8
   chcp 65001 | Out-Null
   ```

3. **CMD 设置 UTF-8**：
   ```bash
   reg add "HKCU\Console" /v CodePage /t REG_DWORD /d 65001 /f
   ```

4. **修复已存在的乱码提交**：
   - 使用 `git commit --amend -F commit_msg.txt`（通过文件传递 UTF-8 消息）
   - 或使用 `git rebase -i` 修改历史提交消息

**解决状态**：
✓ 已解决
- Git 编码配置已设置
- PowerShell 和 CMD UTF-8 配置已完成
- 乱码提交已修复并强制推送
- 后续提交将自动使用 UTF-8 编码

**关键决策**：
- 使用文件方式（`-F`）传递提交消息，避免 PowerShell 编码转换问题
- 强制推送修复后的提交以覆盖远程乱码版本

**相关提交**：
- 1309e201: SYNC: 【小黑：本地】学习了2条新记忆（修复后的版本）

**注意事项**：
- 需要重启 PowerShell/CMD 才能使编码设置生效
- 如果其他终端也使用 Windows，需要同样配置
- 强制推送前需确认没有其他人在使用该分支

